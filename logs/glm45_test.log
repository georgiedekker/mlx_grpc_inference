INFO:__main__:Using DLPack-based tensor serialization for dtype preservation
INFO:     Started server process [4062]
INFO:     Waiting for application startup.
INFO:__main__:ðŸš€ Starting Fixed MLX Distributed Inference API...
INFO:__main__:âœ… Config loaded: mlx-community/GLM-4.5-4bit
INFO:__main__:ðŸ“¦ Loading model and tokenizer...
Fetching 46 files:   0%|          | 0/46 [00:00<?, ?it/s]{"timestamp":"2025-08-03T01:02:33.734742Z","level":"ERROR","fields":{"message":"error downloading range, error: ReqwestMiddlewareError(Middleware(error sending request\n\nCaused by:\n    0: client error (SendRequest)\n    1: connection error\n    2: peer closed connection without sending TLS close_notify: https://docs.rs/rustls/latest/rustls/manual/_03_howto/index.html#unexpected-eof))","caller":"/Users/runner/work/xet-core/xet-core/cas_client/src/download_utils.rs:528"},"filename":"/Users/runner/work/xet-core/xet-core/error_printer/src/lib.rs","line_number":28}
{"timestamp":"2025-08-03T01:02:35.297638Z","level":"ERROR","fields":{"message":"error downloading range, error: ReqwestMiddlewareError(Middleware(error sending request\n\nCaused by:\n    0: client error (SendRequest)\n    1: connection error\n    2: peer closed connection without sending TLS close_notify: https://docs.rs/rustls/latest/rustls/manual/_03_howto/index.html#unexpected-eof))","caller":"/Users/runner/work/xet-core/xet-core/cas_client/src/download_utils.rs:528"},"filename":"/Users/runner/work/xet-core/xet-core/error_printer/src/lib.rs","line_number":28}
{"timestamp":"2025-08-03T01:02:36.006656Z","level":"ERROR","fields":{"message":"error downloading range, error: ReqwestMiddlewareError(Middleware(error sending request\n\nCaused by:\n    0: client error (SendRequest)\n    1: connection error\n    2: peer closed connection without sending TLS close_notify: https://docs.rs/rustls/latest/rustls/manual/_03_howto/index.html#unexpected-eof))","caller":"/Users/runner/work/xet-core/xet-core/cas_client/src/download_utils.rs:528"},"filename":"/Users/runner/work/xet-core/xet-core/error_printer/src/lib.rs","line_number":28}
{"timestamp":"2025-08-03T01:51:40.984741Z","level":"ERROR","fields":{"message":"error downloading range, error: ReqwestMiddlewareError(Middleware(error sending request\n\nCaused by:\n    0: client error (SendRequest)\n    1: connection error\n    2: peer closed connection without sending TLS close_notify: https://docs.rs/rustls/latest/rustls/manual/_03_howto/index.html#unexpected-eof))","caller":"/Users/runner/work/xet-core/xet-core/cas_client/src/download_utils.rs:528"},"filename":"/Users/runner/work/xet-core/xet-core/error_printer/src/lib.rs","line_number":28}
/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 5137.81 MB. The target location /Users/mini1/.cache/huggingface/hub/models--mlx-community--GLM-4.5-4bit/blobs only has 2535.38 MB free disk space.
  warnings.warn(
/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 5137.81 MB. The target location /Users/mini1/.cache/huggingface/hub/models--mlx-community--GLM-4.5-4bit/blobs only has 352.64 MB free disk space.
  warnings.warn(
/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 5229.45 MB. The target location /Users/mini1/.cache/huggingface/hub/models--mlx-community--GLM-4.5-4bit/blobs only has 141.27 MB free disk space.
  warnings.warn(
Fetching 46 files:   7%|â–‹         | 3/46 [1:14:14<17:44:04, 1484.74s/it]
/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 5137.81 MB. The target location /Users/mini1/.cache/huggingface/hub/models--mlx-community--GLM-4.5-4bit/blobs only has 140.55 MB free disk space.
  warnings.warn(
{"timestamp":"2025-08-03T02:09:04.667770Z","level":"WARN","fields":{"message":"Reqwest(reqwest::Error { kind: Request, source: hyper_util::client::legacy::Error(SendRequest, hyper::Error(IncompleteMessage)) }). Retrying..."},"filename":"/Users/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":242}
{"timestamp":"2025-08-03T02:09:04.677183Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 661.87606ms before the next attempt"},"filename":"/Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
--- Logging error ---
Traceback (most recent call last):
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/starlette/routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               ~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mini1/Movies/mlx_grpc_inference/working_api_server_fixed.py", line 102, in lifespan
    tokenizer_config = {
                       ^
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/mlx_lm/utils.py", line 258, in load
    model_path, _ = get_model_path(path_or_hf_repo)
                    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/mlx_lm/utils.py", line 102, in get_model_path
    snapshot_download(
    ~~~~~~~~~~~~~~~~~^
        path_or_hf_repo,
        ^^^^^^^^^^^^^^^^
    ...<11 lines>...
        ],
        ^^
    )
    ^
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/huggingface_hub/_snapshot_download.py", line 332, in snapshot_download
    thread_map(
    ~~~~~~~~~~^
        _inner_hf_hub_download,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        tqdm_class=tqdm_class or hf_tqdm,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/tqdm/contrib/concurrent.py", line 69, in thread_map
    return _executor_map(ThreadPoolExecutor, fn, *iterables, **tqdm_kwargs)
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/tqdm/contrib/concurrent.py", line 51, in _executor_map
    return list(tqdm_class(ex.map(fn, *iterables, chunksize=chunksize), **kwargs))
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
               ^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 619, in result_iterator
    yield _result_or_cancel(fs.pop())
          ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 317, in _result_or_cancel
    return fut.result(timeout)
           ~~~~~~~~~~^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
