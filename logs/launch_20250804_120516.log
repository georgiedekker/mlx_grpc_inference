[0;32m[2025-08-04 12:05:16][0m === MLX Distributed Inference Launcher ===
[0;32m[2025-08-04 12:05:16][0m Timestamp: 20250804_120516
[0;32m[2025-08-04 12:05:16][0m Log directory: /Users/mini1/Movies/mlx_grpc_inference/logs
[0;32m[2025-08-04 12:05:16][0m Cleaning up existing processes...
[0;32m[2025-08-04 12:05:18][0m Configuring network...
[0;32m[2025-08-04 12:05:18][0m Setting MTU to 9000 on bridge0...
[1;33m[2025-08-04 12:05:18] WARNING:[0m Could not set MTU
[0;32m[2025-08-04 12:05:18][0m Testing SSH connectivity to 192.168.5.2...
SSH OK
mini2.local
Python 3.9.6
[0;32m[2025-08-04 12:05:18][0m âœ… SSH connectivity confirmed
[0;32m[2025-08-04 12:05:18][0m Testing basic MPI connectivity...
[0;32m[2025-08-04 12:05:18][0m Running basic MPI test...
/Library/Developer/CommandLineTools/usr/bin/python3: can't open file '/Users/mini1/test_mpi.py': [Errno 2] No such file or directory
--------------------------------------------------------------------------
prterun detected that one or more processes exited with non-zero status,
thus causing the job to be terminated. The first process to do so was:

   Process name: [prterun-mini1-78917@1,1]
   Exit code:    2
--------------------------------------------------------------------------
[0;32m[2025-08-04 12:05:19][0m âœ… Basic MPI test passed
[0;32m[2025-08-04 12:05:19][0m Setting up remote files on 192.168.5.2...
[0;32m[2025-08-04 12:05:19][0m Copying files to remote...
[0;32m[2025-08-04 12:05:20][0m Remote setup complete
[0;32m[2025-08-04 12:05:20][0m Launching with Ring backend over Thunderbolt...
[0;32m[2025-08-04 12:05:20][0m Ring backend launched with PID 78962
[0;32m[2025-08-04 12:05:20][0m Waiting for API server to start...
Permission denied, please try again.
Received disconnect from 192.168.5.1 port 22:2: Too many authentication failures
Disconnected from 192.168.5.1 port 22
Exception in thread Thread-1 (node_thread):
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 1043, in _bootstrap_inner
    self.run()
    ~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/mlx/distributed_run.py", line 325, in node_thread
    c = run(cmd, check=True, shell=True, capture_output=True, text=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/subprocess.py", line 577, in run
    raise CalledProcessError(retcode, process.args,
                             output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command 'ssh 192.168.5.1 'pid=$(cat Warning: Permanently added '192.168.5.1' (ED25519) to the list of known hosts.); if ps -p $pid >/dev/null; then     kill $pid;     echo 1; else     echo 0; fi; rm Warning: Permanently added '192.168.5.1' (ED25519) to the list of known hosts.'' returned non-zero exit status 255.
Exception in thread Thread-2 (node_thread):
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 1043, in _bootstrap_inner
    self.run()
    ~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/mlx/distributed_run.py", line 325, in node_thread
    c = run(cmd, check=True, shell=True, capture_output=True, text=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/subprocess.py", line 577, in run
    raise CalledProcessError(retcode, process.args,
                             output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command 'ssh 192.168.5.2 'pid=$(cat ); if ps -p $pid >/dev/null; then     kill $pid;     echo 1; else     echo 0; fi; rm '' returned non-zero exit status 64.
[0;31m[2025-08-04 12:06:22] ERROR:[0m API server failed to start after 60 seconds
[0;31m[2025-08-04 12:06:22] ERROR:[0m Server failed to start. Check logs in /Users/mini1/Movies/mlx_grpc_inference/logs/
