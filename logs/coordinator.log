/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
2025-08-05 13:12:05,412 - [server_distributed] Rank 0 - INFO - Initializing server on rank 0
2025-08-05 13:12:05,412 - [server_distributed] Rank 0 - INFO - Coordinator connecting to workers...
2025-08-05 13:12:08,413 - [server_distributed] Rank 0 - INFO - Connecting to worker 1 at 192.168.5.2:50052
2025-08-05 13:12:08,423 - [server_distributed] Rank 0 - INFO - Worker 1 responded: healthy=True, device=mini2
2025-08-05 13:12:08,423 - [server_distributed] Rank 0 - INFO - Loading model mlx-community/Qwen3-1.7B-8bit
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1754392328.773513 2754515 fork_posix.cc:71] Other threads are currently calling into gRPC, skipping fork() handlers
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|██████████| 9/9 [00:00<00:00, 109734.70it/s]
2025-08-05 13:12:10,108 - [server_distributed] Rank 0 - INFO - Model loaded, coordinator handling layers: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
2025-08-05 13:12:10,109 - [server_distributed] Rank 0 - INFO - Total layers: 28, Workers will handle remaining layers
2025-08-05 13:12:10,109 - [server_distributed] Rank 0 - INFO - Initialized persistent KV cache with 28 MLX KVCache objects
2025-08-05 13:12:10,109 - [server_distributed] Rank 0 - INFO - Cache list object ID: 14238545088
2025-08-05 13:12:10,109 - [server_distributed] Rank 0 - INFO - Individual cache object IDs: [4972658176, 4972636880, 4972638480, 4972552592, 4972552896]... (showing first 5)
2025-08-05 13:12:10,109 - [server_distributed] Rank 0 - INFO - Server initialized successfully on rank 0
INFO:     Started server process [87730]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8100 (Press CTRL+C to quit)
INFO:     127.0.0.1:53735 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53737 - "GET /health HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [87730]
/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/resource_tracker.py:301: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/mp-unojrj9d'}
  warnings.warn(
