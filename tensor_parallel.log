/Users/mini1/Movies/mlx_grpc_inference/tensor_parallel_server.py:168: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [18433]
INFO:     Waiting for application startup.
INFO:__main__:Loading model for tensor parallel sharding...
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|██████████| 9/9 [00:00<00:00, 105738.76it/s]
INFO:__main__:Sharding model weights across 2 devices...
INFO:src.tensor_parallel:Sharded model into 2 parts
INFO:src.tensor_parallel:Device 0: 252 weight tensors
INFO:src.tensor_parallel:Device 1: 252 weight tensors
INFO:__main__:Connected to worker on mini2
INFO:__main__:Tensor parallel coordinator initialized
INFO:__main__:API server initialized with tensor parallel coordinator
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8100 (Press CTRL+C to quit)
INFO:     127.0.0.1:63501 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63504 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63507 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63510 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63513 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63516 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63519 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63522 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63525 - "GET /health HTTP/1.1" 200 OK
INFO:__main__:Processing prompt with temperature=0.1, max_tokens=150
INFO:__main__:Generated 150 tokens in 3.03s (~53.8 tok/s overall)
INFO:     192.168.2.106:54829 - "POST /v1/chat/completions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63528 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63532 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63535 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63538 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63541 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63547 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63549 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63551 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63576 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63579 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63581 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63583 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63585 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63587 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63589 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63591 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63593 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63595 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63597 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63619 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63621 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63642 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63644 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63646 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63648 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63651 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63653 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63655 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63657 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63659 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63661 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63686 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63688 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63709 - "GET /health HTTP/1.1" 200 OK
