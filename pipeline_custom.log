2025-08-06 23:39:44,624 - INFO - Loading model: mlx-community/Qwen3-1.7B-8bit
2025-08-06 23:39:44,634 - INFO - Loading model: mlx-community/Qwen3-1.7B-8bit
2025-08-06 23:39:44,688 - INFO - Distributed initialized: rank=0, world_size=2
2025-08-06 23:39:44,688 - INFO - Rank 0: Downloading model metadata...
2025-08-06 23:39:44,706 - INFO - Distributed initialized: rank=1, world_size=2
2025-08-06 23:39:44,706 - INFO - Rank 1: Downloading model metadata...
Fetching 8 files:   0%|          | 0/8 [00:00<?, ?it/s]Fetching 8 files: 100%|██████████| 8/8 [00:00<00:00, 107892.06it/s]
2025-08-06 23:39:44,884 - INFO - Rank 0: Lazy loading model to determine sharding...
2025-08-06 23:39:44,901 - WARNING - Model mlx-community/Qwen3-1.7B-8bit doesn't have native pipeline() support
2025-08-06 23:39:44,901 - INFO - Adding custom pipeline() implementation...
2025-08-06 23:39:44,901 - INFO - Added pipeline() method to Qwen3Model
2025-08-06 23:39:44,901 - INFO - ✅ Custom pipeline() method added successfully!
2025-08-06 23:39:44,901 - INFO - Rank 0: Applying pipeline sharding...
2025-08-06 23:39:44,901 - INFO - Applying pipeline parallelism: rank 0/2
2025-08-06 23:39:44,901 - INFO - Found 28 transformer layers
2025-08-06 23:39:44,901 - INFO - Rank 0: Assigned layers 0-13
2025-08-06 23:39:44,901 - INFO - Rank 0: Pipeline setup complete
2025-08-06 23:39:44,902 - INFO - Rank 0: Downloading 1 weight files for this shard...
Fetching 8 files:   0%|          | 0/8 [00:00<?, ?it/s]Fetching 8 files: 100%|██████████| 8/8 [00:00<00:00, 82443.32it/s]
2025-08-06 23:39:44,959 - INFO - Rank 1: Lazy loading model to determine sharding...
2025-08-06 23:39:44,985 - WARNING - Model mlx-community/Qwen3-1.7B-8bit doesn't have native pipeline() support
2025-08-06 23:39:44,985 - INFO - Adding custom pipeline() implementation...
2025-08-06 23:39:44,985 - INFO - Added pipeline() method to Qwen3Model
2025-08-06 23:39:44,985 - INFO - ✅ Custom pipeline() method added successfully!
2025-08-06 23:39:44,985 - INFO - Rank 1: Applying pipeline sharding...
2025-08-06 23:39:44,985 - INFO - Applying pipeline parallelism: rank 1/2
2025-08-06 23:39:44,985 - INFO - Found 28 transformer layers
2025-08-06 23:39:44,985 - INFO - Rank 1: Assigned layers 14-27
2025-08-06 23:39:44,985 - INFO - Rank 1: Pipeline setup complete
2025-08-06 23:39:44,987 - INFO - Rank 1: Downloading 1 weight files for this shard...
Fetching 1 files:   0%|          | 0/1 [00:00<?, ?it/s]Fetching 1 files: 100%|██████████| 1/1 [00:00<00:00, 18893.26it/s]
Fetching 1 files:   0%|          | 0/1 [00:00<?, ?it/s]Fetching 1 files: 100%|██████████| 1/1 [00:00<00:00, 22192.08it/s]
2025-08-06 23:39:45,303 - INFO - Rank 0: Loading model weights for this shard...
Traceback (most recent call last):
  File "/Users/mini1/Movies/mlx_grpc_inference/pipeline_server.py", line 409, in <module>
    main()
    ~~~~^^
  File "/Users/mini1/Movies/mlx_grpc_inference/pipeline_server.py", line 273, in main
    shard_and_load(model_name)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/mini1/Movies/mlx_grpc_inference/pipeline_server.py", line 160, in shard_and_load
    model.model.pipeline(group)
    ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mini1/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/mlx/nn/layers/base.py", line 103, in __getattr__
    super(Module, self).__getattribute__(key)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
AttributeError: 'Qwen3Model' object has no attribute 'pipeline'
2025-08-06 23:39:45,383 - INFO - Rank 1: Loading model weights for this shard...
Traceback (most recent call last):
  File "/Users/mini2/Movies/mlx_grpc_inference/pipeline_server.py", line 409, in <module>
    main()
    ~~~~^^
  File "/Users/mini2/Movies/mlx_grpc_inference/pipeline_server.py", line 273, in main
    shard_and_load(model_name)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/mini2/Movies/mlx_grpc_inference/pipeline_server.py", line 160, in shard_and_load
    model.model.pipeline(group)
    ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mini2/Movies/mlx_grpc_inference/.venv/lib/python3.13/site-packages/mlx/nn/layers/base.py", line 103, in __getattr__
    super(Module, self).__getattribute__(key)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
AttributeError: 'Qwen3Model' object has no attribute 'pipeline'
--------------------------------------------------------------------------
prterun detected that one or more processes exited with non-zero status,
thus causing the job to be terminated. The first process to do so was:

   Process name: [prterun-mini1-8041@1,0]
   Exit code:    1
--------------------------------------------------------------------------
